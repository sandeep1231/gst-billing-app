{"ast":null,"code":"import { inject } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ApiService } from '../../services/api.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nexport let DashboardPage = /*#__PURE__*/(() => {\n  class DashboardPage {\n    constructor() {\n      this.api = inject(ApiService);\n      this.today = {\n        count: 0,\n        total: 0\n      };\n      this.mtd = {\n        count: 0,\n        total: 0\n      };\n      this.counts = {\n        products: 0,\n        customers: 0,\n        invoices: 0\n      };\n      this.lowStock = 0;\n    }\n    ngOnInit() {\n      // Derive IST current date regardless of user local timezone\n      const IST_OFFSET_MINUTES = 330;\n      const nowUtc = new Date();\n      const istNow = new Date(nowUtc.getTime() + IST_OFFSET_MINUTES * 60000);\n      const yyyyMmDd = (y, m, d) => `${y.toString().padStart(4, '0')}-${(m + 1).toString().padStart(2, '0')}-${d.toString().padStart(2, '0')}`;\n      const todayStr = yyyyMmDd(istNow.getFullYear(), istNow.getMonth(), istNow.getDate());\n      const monthStartStr = yyyyMmDd(istNow.getFullYear(), istNow.getMonth(), 1);\n      // Today (IST)\n      this.api.get('/reports/sales', {\n        from: todayStr,\n        to: todayStr\n      }).subscribe({\n        next: d => this.today = d\n      });\n      // Month to date (IST) - from first of month to today\n      this.api.get('/reports/sales', {\n        from: monthStartStr,\n        to: todayStr\n      }).subscribe({\n        next: d => this.mtd = d\n      });\n      // Counts\n      this.api.get('/reports/counts').subscribe({\n        next: d => this.counts = d\n      });\n      // Low stock\n      this.api.get('/reports/stock').subscribe({\n        next: rows => {\n          this.lowStock = rows.filter(r => (r.onHand ?? 0) <= 5).length;\n        }\n      });\n    }\n    static {\n      this.ɵfac = function DashboardPage_Factory(t) {\n        return new (t || DashboardPage)();\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: DashboardPage,\n        selectors: [[\"ng-component\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 39,\n        vars: 13,\n        consts: [[1, \"row\", \"g-3\", \"mb-3\"], [1, \"col-md-3\"], [1, \"card\", \"text-bg-light\"], [1, \"card-body\"], [1, \"text-muted\"], [1, \"h5\", \"mb-0\"]],\n        template: function DashboardPage_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"h4\");\n            i0.ɵɵtext(1, \"Dashboard\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(2, \"div\", 0)(3, \"div\", 1)(4, \"div\", 2)(5, \"div\", 3)(6, \"div\", 4);\n            i0.ɵɵtext(7, \"Today Sales\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"div\", 5);\n            i0.ɵɵtext(9);\n            i0.ɵɵpipe(10, \"number\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(11, \"small\", 4);\n            i0.ɵɵtext(12);\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(13, \"div\", 1)(14, \"div\", 2)(15, \"div\", 3)(16, \"div\", 4);\n            i0.ɵɵtext(17, \"MTD Sales\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(18, \"div\", 5);\n            i0.ɵɵtext(19);\n            i0.ɵɵpipe(20, \"number\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(21, \"small\", 4);\n            i0.ɵɵtext(22);\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(23, \"div\", 1)(24, \"div\", 2)(25, \"div\", 3)(26, \"div\", 4);\n            i0.ɵɵtext(27, \"Customers\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(28, \"div\", 5);\n            i0.ɵɵtext(29);\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(30, \"div\", 1)(31, \"div\", 2)(32, \"div\", 3)(33, \"div\", 4);\n            i0.ɵɵtext(34, \"Products\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(35, \"div\", 5);\n            i0.ɵɵtext(36);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(37, \"small\", 4);\n            i0.ɵɵtext(38);\n            i0.ɵɵelementEnd()()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(9);\n            i0.ɵɵtextInterpolate1(\"\\u20B9\", i0.ɵɵpipeBind2(10, 7, ctx.today.total, \"1.2-2\"), \"\");\n            i0.ɵɵadvance(3);\n            i0.ɵɵtextInterpolate1(\"Invoices: \", ctx.today.count, \"\");\n            i0.ɵɵadvance(7);\n            i0.ɵɵtextInterpolate1(\"\\u20B9\", i0.ɵɵpipeBind2(20, 10, ctx.mtd.total, \"1.2-2\"), \"\");\n            i0.ɵɵadvance(3);\n            i0.ɵɵtextInterpolate1(\"Invoices: \", ctx.mtd.count, \"\");\n            i0.ɵɵadvance(7);\n            i0.ɵɵtextInterpolate(ctx.counts.customers);\n            i0.ɵɵadvance(7);\n            i0.ɵɵtextInterpolate(ctx.counts.products);\n            i0.ɵɵadvance(2);\n            i0.ɵɵtextInterpolate1(\"Low stock: \", ctx.lowStock, \"\");\n          }\n        },\n        dependencies: [CommonModule, i1.DecimalPipe],\n        encapsulation: 2\n      });\n    }\n  }\n  return DashboardPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}