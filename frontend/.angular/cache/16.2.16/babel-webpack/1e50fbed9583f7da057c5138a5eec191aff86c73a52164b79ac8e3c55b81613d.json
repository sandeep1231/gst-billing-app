{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/api.service\";\nimport * as i2 from \"../../services/products.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction StockPage_tr_23_ng_container_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const r_r2 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(r_r2.openingQty || 0);\n  }\n}\nfunction StockPage_tr_23_ng_template_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"input\", 10);\n    i0.ɵɵlistener(\"ngModelChange\", function StockPage_tr_23_ng_template_7_Template_input_ngModelChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r9.editQty = $event);\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngModel\", ctx_r5.editQty);\n  }\n}\nfunction StockPage_tr_23_button_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function StockPage_tr_23_button_22_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const r_r2 = i0.ɵɵnextContext().$implicit;\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.startEdit(r_r2));\n    });\n    i0.ɵɵtext(1, \"Edit\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction StockPage_tr_23_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function StockPage_tr_23_div_23_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const r_r2 = i0.ɵɵnextContext().$implicit;\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.save(r_r2));\n    });\n    i0.ɵɵtext(2, \"Save\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function StockPage_tr_23_div_23_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r17 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r17.cancel());\n    });\n    i0.ɵɵtext(4, \"Cancel\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction StockPage_tr_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\", 3);\n    i0.ɵɵtemplate(6, StockPage_tr_23_ng_container_6_Template, 2, 1, \"ng-container\", 6);\n    i0.ɵɵtemplate(7, StockPage_tr_23_ng_template_7_Template, 1, 1, \"ng-template\", null, 7, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\", 3);\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"td\", 3);\n    i0.ɵɵtext(13);\n    i0.ɵɵpipe(14, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"td\", 3);\n    i0.ɵɵtext(16);\n    i0.ɵɵpipe(17, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"td\", 3);\n    i0.ɵɵtext(19);\n    i0.ɵɵpipe(20, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"td\", 3);\n    i0.ɵɵtemplate(22, StockPage_tr_23_button_22_Template, 2, 0, \"button\", 8);\n    i0.ɵɵtemplate(23, StockPage_tr_23_div_23_Template, 5, 0, \"div\", 9);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const r_r2 = ctx.$implicit;\n    const _r4 = i0.ɵɵreference(8);\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(r_r2.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(r_r2.unit || \"-\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.editId !== r_r2.productId)(\"ngIfElse\", _r4);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(11, 10, r_r2.soldQty, \"1.0-2\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(14, 13, r_r2.onHand, \"1.0-2\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(17, 16, r_r2.price, \"1.2-2\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(20, 19, r_r2.revenue, \"1.2-2\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.editId !== r_r2.productId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.editId === r_r2.productId);\n  }\n}\nfunction StockPage_tr_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 15);\n    i0.ɵɵtext(2, \"No products\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let StockPage = /*#__PURE__*/(() => {\n  class StockPage {\n    constructor(api, products) {\n      this.api = api;\n      this.products = products;\n      this.rows = [];\n      this.loading = false;\n      this.editId = null;\n      this.editQty = 0;\n    }\n    ngOnInit() {\n      this.reload();\n    }\n    reload() {\n      this.loading = true;\n      this.api.get('/reports/stock').subscribe({\n        next: data => {\n          this.rows = data;\n          this.loading = false;\n        },\n        error: () => {\n          this.rows = [];\n          this.loading = false;\n        }\n      });\n    }\n    startEdit(r) {\n      this.editId = r.productId;\n      this.editQty = r.openingQty || 0;\n    }\n    cancel() {\n      this.editId = null;\n    }\n    save(r) {\n      if (!this.editId) return;\n      this.products.update(this.editId, {\n        openingQty: Number(this.editQty)\n      }).subscribe({\n        next: p => {\n          this.editId = null;\n          this.reload();\n        },\n        error: () => {\n          this.editId = null;\n          this.reload();\n        }\n      });\n    }\n    static {\n      this.ɵfac = function StockPage_Factory(t) {\n        return new (t || StockPage)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.ProductsService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: StockPage,\n        selectors: [[\"ng-component\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 25,\n        vars: 2,\n        consts: [[1, \"mb-3\"], [1, \"table-responsive\"], [1, \"table\", \"table-sm\", \"align-middle\"], [1, \"text-end\"], [4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [4, \"ngIf\", \"ngIfElse\"], [\"editTpl\", \"\"], [\"class\", \"btn btn-sm btn-outline-primary\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"btn-group btn-group-sm\", 4, \"ngIf\"], [\"type\", \"number\", 1, \"form-control\", \"form-control-sm\", \"text-end\", 3, \"ngModel\", \"ngModelChange\"], [1, \"btn\", \"btn-sm\", \"btn-outline-primary\", 3, \"click\"], [1, \"btn-group\", \"btn-group-sm\"], [1, \"btn\", \"btn-success\", 3, \"click\"], [1, \"btn\", \"btn-outline-secondary\", 3, \"click\"], [\"colspan\", \"8\", 1, \"text-center\", \"text-muted\"]],\n        template: function StockPage_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"h4\", 0);\n            i0.ɵɵtext(1, \"Stock\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(2, \"div\", 1)(3, \"table\", 2)(4, \"thead\")(5, \"tr\")(6, \"th\");\n            i0.ɵɵtext(7, \"Product\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"th\");\n            i0.ɵɵtext(9, \"Unit\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(10, \"th\", 3);\n            i0.ɵɵtext(11, \"Opening Qty\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(12, \"th\", 3);\n            i0.ɵɵtext(13, \"Sold Qty\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(14, \"th\", 3);\n            i0.ɵɵtext(15, \"On Hand\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(16, \"th\", 3);\n            i0.ɵɵtext(17, \"Price (\\u20B9)\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(18, \"th\", 3);\n            i0.ɵɵtext(19, \"Revenue (\\u20B9)\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(20, \"th\", 3);\n            i0.ɵɵtext(21, \"Action\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(22, \"tbody\");\n            i0.ɵɵtemplate(23, StockPage_tr_23_Template, 24, 22, \"tr\", 4);\n            i0.ɵɵtemplate(24, StockPage_tr_24_Template, 3, 0, \"tr\", 5);\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(23);\n            i0.ɵɵproperty(\"ngForOf\", ctx.rows);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", !ctx.loading && ctx.rows.length === 0);\n          }\n        },\n        dependencies: [CommonModule, i3.NgForOf, i3.NgIf, i3.DecimalPipe, FormsModule, i4.DefaultValueAccessor, i4.NumberValueAccessor, i4.NgControlStatus, i4.NgModel],\n        encapsulation: 2\n      });\n    }\n  }\n  return StockPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}