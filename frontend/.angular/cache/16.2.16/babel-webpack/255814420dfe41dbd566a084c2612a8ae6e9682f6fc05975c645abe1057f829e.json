{"ast":null,"code":"import { inject } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormBuilder, ReactiveFormsModule, Validators } from '@angular/forms';\nimport { CompanyService } from '../../services/company.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/forms\";\nfunction SettingsPage_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22);\n    i0.ɵɵtext(1, \"Invalid GSTIN format\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SettingsPage_option_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 23);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const s_r3 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", s_r3.code);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\"\", s_r3.name, \" (\", s_r3.code, \")\");\n  }\n}\nfunction SettingsPage_div_45_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtext(1, \"Saved.\");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let SettingsPage = /*#__PURE__*/(() => {\n  class SettingsPage {\n    constructor() {\n      this.fb = inject(FormBuilder);\n      this.svc = inject(CompanyService);\n      this.saving = false;\n      this.saved = false;\n      // Common Indian states/UTs with 2-letter codes used in this app\n      this.states = [{\n        code: 'AN',\n        name: 'Andaman & Nicobar'\n      }, {\n        code: 'AP',\n        name: 'Andhra Pradesh'\n      }, {\n        code: 'AR',\n        name: 'Arunachal Pradesh'\n      }, {\n        code: 'AS',\n        name: 'Assam'\n      }, {\n        code: 'BR',\n        name: 'Bihar'\n      }, {\n        code: 'CH',\n        name: 'Chandigarh'\n      }, {\n        code: 'CT',\n        name: 'Chhattisgarh'\n      }, {\n        code: 'DL',\n        name: 'Delhi'\n      }, {\n        code: 'DN',\n        name: 'Dadra & Nagar Haveli and Daman & Diu'\n      }, {\n        code: 'GA',\n        name: 'Goa'\n      }, {\n        code: 'GJ',\n        name: 'Gujarat'\n      }, {\n        code: 'HP',\n        name: 'Himachal Pradesh'\n      }, {\n        code: 'HR',\n        name: 'Haryana'\n      }, {\n        code: 'JH',\n        name: 'Jharkhand'\n      }, {\n        code: 'JK',\n        name: 'Jammu & Kashmir'\n      }, {\n        code: 'KA',\n        name: 'Karnataka'\n      }, {\n        code: 'KL',\n        name: 'Kerala'\n      }, {\n        code: 'LA',\n        name: 'Ladakh'\n      }, {\n        code: 'LD',\n        name: 'Lakshadweep'\n      }, {\n        code: 'MH',\n        name: 'Maharashtra'\n      }, {\n        code: 'ML',\n        name: 'Meghalaya'\n      }, {\n        code: 'MN',\n        name: 'Manipur'\n      }, {\n        code: 'MP',\n        name: 'Madhya Pradesh'\n      }, {\n        code: 'MZ',\n        name: 'Mizoram'\n      }, {\n        code: 'NL',\n        name: 'Nagaland'\n      }, {\n        code: 'OD',\n        name: 'Odisha'\n      }, {\n        code: 'PB',\n        name: 'Punjab'\n      }, {\n        code: 'PY',\n        name: 'Puducherry'\n      }, {\n        code: 'RJ',\n        name: 'Rajasthan'\n      }, {\n        code: 'SK',\n        name: 'Sikkim'\n      }, {\n        code: 'TN',\n        name: 'Tamil Nadu'\n      }, {\n        code: 'TG',\n        name: 'Telangana'\n      }, {\n        code: 'TR',\n        name: 'Tripura'\n      }, {\n        code: 'UP',\n        name: 'Uttar Pradesh'\n      }, {\n        code: 'UK',\n        name: 'Uttarakhand'\n      }, {\n        code: 'WB',\n        name: 'West Bengal'\n      }];\n      this.form = this.fb.group({\n        name: ['', Validators.required],\n        gstin: ['', [Validators.pattern(/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z][0-9A-Z]Z[0-9A-Z]$/)]],\n        stateCode: [''],\n        line1: [''],\n        line2: [''],\n        city: [''],\n        state: [''],\n        pincode: ['']\n      });\n    }\n    ngOnInit() {\n      this.reload();\n    }\n    reload() {\n      this.saved = false;\n      this.svc.getMe().subscribe({\n        next: c => {\n          this.form.patchValue({\n            name: c.name,\n            gstin: c.gstin || '',\n            stateCode: c.stateCode || '',\n            line1: c.address?.line1 || '',\n            line2: c.address?.line2 || '',\n            city: c.address?.city || '',\n            state: c.address?.state || '',\n            pincode: c.address?.pincode || ''\n          });\n        }\n      });\n    }\n    save() {\n      if (this.form.invalid) return;\n      this.saving = true;\n      const v = this.form.value;\n      const body = {\n        name: v.name,\n        gstin: (v.gstin || '').toUpperCase() || undefined,\n        stateCode: (v.stateCode || '').toUpperCase() || undefined,\n        address: {\n          line1: v.line1 || undefined,\n          line2: v.line2 || undefined,\n          city: v.city || undefined,\n          state: v.state || undefined,\n          pincode: v.pincode || undefined\n        }\n      };\n      this.svc.updateMe(body).subscribe({\n        next: () => {\n          this.saving = false;\n          this.saved = true;\n        },\n        error: () => {\n          this.saving = false;\n          this.saved = false;\n        }\n      });\n    }\n    gstinInvalid() {\n      const c = this.form.get('gstin');\n      return !!c && c.touched && c.value && c.invalid;\n    }\n    uppercase(field) {\n      const c = this.form.get(field);\n      if (c && typeof c.value === 'string') c.setValue(c.value.toUpperCase());\n    }\n    static {\n      this.ɵfac = function SettingsPage_Factory(t) {\n        return new (t || SettingsPage)();\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: SettingsPage,\n        selectors: [[\"app-settings\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 46,\n        vars: 8,\n        consts: [[1, \"d-flex\", \"align-items-center\", \"mb-3\"], [1, \"m-0\"], [1, \"row\", \"g-3\", 3, \"formGroup\", \"ngSubmit\"], [1, \"col-md-6\"], [1, \"form-label\"], [\"formControlName\", \"name\", 1, \"form-control\"], [1, \"col-md-3\"], [\"formControlName\", \"gstin\", 1, \"form-control\", 3, \"blur\"], [\"class\", \"invalid-feedback\", 4, \"ngIf\"], [\"formControlName\", \"stateCode\", 1, \"form-select\"], [\"value\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"formControlName\", \"line1\", 1, \"form-control\"], [\"formControlName\", \"line2\", 1, \"form-control\"], [1, \"col-md-4\"], [\"formControlName\", \"city\", 1, \"form-control\"], [\"formControlName\", \"state\", 1, \"form-control\"], [\"formControlName\", \"pincode\", 1, \"form-control\"], [1, \"col-12\", \"d-flex\", \"gap-2\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [\"type\", \"button\", 1, \"btn\", \"btn-outline-secondary\", 3, \"disabled\", \"click\"], [\"class\", \"ms-auto\", \"style\", \"align-self:center; color: #198754;\", 4, \"ngIf\"], [1, \"invalid-feedback\"], [3, \"value\"], [1, \"ms-auto\", 2, \"align-self\", \"center\", \"color\", \"#198754\"]],\n        template: function SettingsPage_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"h4\", 1);\n            i0.ɵɵtext(2, \"Company Settings\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(3, \"form\", 2);\n            i0.ɵɵlistener(\"ngSubmit\", function SettingsPage_Template_form_ngSubmit_3_listener() {\n              return ctx.save();\n            });\n            i0.ɵɵelementStart(4, \"div\", 3)(5, \"label\", 4);\n            i0.ɵɵtext(6, \"Company Name\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(7, \"input\", 5);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"div\", 6)(9, \"label\", 4);\n            i0.ɵɵtext(10, \"GSTIN\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(11, \"input\", 7);\n            i0.ɵɵlistener(\"blur\", function SettingsPage_Template_input_blur_11_listener() {\n              return ctx.uppercase(\"gstin\");\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(12, SettingsPage_div_12_Template, 2, 0, \"div\", 8);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(13, \"div\", 6)(14, \"label\", 4);\n            i0.ɵɵtext(15, \"State Code\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(16, \"select\", 9)(17, \"option\", 10);\n            i0.ɵɵtext(18, \"-- Select --\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(19, SettingsPage_option_19_Template, 2, 3, \"option\", 11);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(20, \"div\", 3)(21, \"label\", 4);\n            i0.ɵɵtext(22, \"Address Line 1\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(23, \"input\", 12);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(24, \"div\", 3)(25, \"label\", 4);\n            i0.ɵɵtext(26, \"Address Line 2\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(27, \"input\", 13);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(28, \"div\", 14)(29, \"label\", 4);\n            i0.ɵɵtext(30, \"City\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(31, \"input\", 15);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(32, \"div\", 14)(33, \"label\", 4);\n            i0.ɵɵtext(34, \"State\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(35, \"input\", 16);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(36, \"div\", 14)(37, \"label\", 4);\n            i0.ɵɵtext(38, \"PIN Code\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(39, \"input\", 17);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(40, \"div\", 18)(41, \"button\", 19);\n            i0.ɵɵtext(42, \"Save\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(43, \"button\", 20);\n            i0.ɵɵlistener(\"click\", function SettingsPage_Template_button_click_43_listener() {\n              return ctx.reload();\n            });\n            i0.ɵɵtext(44, \"Reload\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(45, SettingsPage_div_45_Template, 2, 0, \"div\", 21);\n            i0.ɵɵelementEnd()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"formGroup\", ctx.form);\n            i0.ɵɵadvance(8);\n            i0.ɵɵclassProp(\"is-invalid\", ctx.gstinInvalid());\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", ctx.gstinInvalid());\n            i0.ɵɵadvance(7);\n            i0.ɵɵproperty(\"ngForOf\", ctx.states);\n            i0.ɵɵadvance(22);\n            i0.ɵɵproperty(\"disabled\", ctx.form.invalid || ctx.saving);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"disabled\", ctx.saving);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngIf\", ctx.saved);\n          }\n        },\n        dependencies: [CommonModule, i1.NgForOf, i1.NgIf, ReactiveFormsModule, i2.ɵNgNoValidate, i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i2.DefaultValueAccessor, i2.SelectControlValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormControlName],\n        encapsulation: 2\n      });\n    }\n  }\n  return SettingsPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}